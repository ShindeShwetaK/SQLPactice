1 - Return Orders Customer Feedback

Namastekart, an e-commerce company, has observed a notable surge in return orders recently. They suspect that a specific group of customers may
be responsible for a significant portion of these returns. To address this issue, their initial goal is to identify customers who have returned
more than 50% of their orders. This way, they can proactively reach out to these customers to gather feedback.

Write an SQL to find list of customers along with their return percent (Round to 2 decimal places), display the output in ascending order of customer name.

Table: orders (primary key : order_id)
+---------------+-------------+
| COLUMN_NAME   | DATA_TYPE   |
+---------------+-------------+
| customer_name | varchar(10) |
| order_date    | date        |
| order_id      | int         |
| sales         | int         |
+---------------+-------------+

Table: returns (primary key : order_id)
+-------------+-----------+
| COLUMN_NAME | DATA_TYPE |
+-------------+-----------+
| order_id    | int       |
| return_date | date      |
+-------------+-----------+

Ans:-
select o.customer_name, round(count(r.order_id)*100/count(*),2)return_percentage
from orders o left join returns r on o.order_id = r.order_id
group by o.customer_name
having return_percentage > 50
order by o.customer_name;

########################################################################################################################
2 - Product Category
You are provided with a table named Products containing information about various products, including their names and prices. 
Write a SQL query to count number of products in each category based on its price into three categories below. Display the output in descending 
order of no of products.

1- "Low Price" for products with a price less than 100
2- "Medium Price" for products with a price between 100 and 500 (inclusive)
3- "High Price" for products with a price greater than 500.
Tables: Products
+--------------+-------------+
| COLUMN_NAME  | DATA_TYPE   |
+--------------+-------------+
| product_id   | int         |
| product_name | varchar(20) |
| price        | int         |
+--------------+-------------+

Ans:-
with cte as (
select product_id, product_name, price,
case 
when price < 100 then 'Low Price'
when price >= 100 and price <= 500 then 'Medium Price'
else 'High Price' 
end as category
from products )
select category, count(*) as no_of_products
from cte 
group by category
order by no_of_products desc;

########################################################################################################################
3-

########################################################################################################################
4-
########################################################################################################################
5-
########################################################################################################################
6 - Electricity Consumption

You have access to data from an electricity billing system, detailing the electricity usage and cost for specific
households over billing periods in the years 2023 and 2024. Your objective is to present the total electricity consumption, 
total cost and average monthly consumption for each household per year display the output in ascending order of each household id & year of the bill.

Tables: electricity_bill
+-----------------+---------------+
| COLUMN_NAME     | DATA_TYPE     |
+-----------------+---------------+
| bill_id         | int           |
| household_id    | int           |
| billing_period  | varchar(7)    |
| consumption_kwh | decimal(10,2) |
| total_cost      | decimal(10,2) |
+-----------------+---------------+

Ans:-
select household_id, 
LEFT(billing_period, 4)as bill_year,
sum(consumption_kwh) as consumption_kwh,
sum(total_cost) As total_cost,
avg(consumption_kwh) as avg_consumption_kwh
from electricity_bill 
group by household_id, bill_year
order by household_id, bill_year;

########################################################################################################################
7
########################################################################################################################
8 - Library Borrowing Habits
  Write an SQL to display the name of each borrower along with a comma-separated list of the books they have borrowed in alphabetical order
  , display the output in ascending order of Borrower Name.

Tables: Books
+-------------+-------------+
| COLUMN_NAME | DATA_TYPE   |
+-------------+-------------+
| BookID      | int         |
| BookName    | varchar(30) |
| Genre       | varchar(20) |
+-------------+-------------+

Tables: Borrowers
+--------------+-------------+
| COLUMN_NAME  | DATA_TYPE   |
+--------------+-------------+
| BorrowerID   | int         |
| BorrowerName | varchar(10) |
| BookID       | int         |
+--------------+-------------+

  Ans:- 
  select 
b.borrowerName,
Group_CONCAT(bk.bookname order by bk.bookname separator ',') as BorrowedBooks
from Borrowers b 
left Join books bk on b.bookid = bk.bookid
group by 
    b.BorrowerName                                                    
ORDER BY 
    b.BorrowerName ASC; 

########################################################################################################################

########################################################################################################################

########################################################################################################################

########################################################################################################################

########################################################################################################################

########################################################################################################################

########################################################################################################################

########################################################################################################################

########################################################################################################################

########################################################################################################################

########################################################################################################################

########################################################################################################################

########################################################################################################################

########################################################################################################################
########################################################################################################################

########################################################################################################################

########################################################################################################################

########################################################################################################################

########################################################################################################################

########################################################################################################################

########################################################################################################################

########################################################################################################################

########################################################################################################################

########################################################################################################################

########################################################################################################################

########################################################################################################################

########################################################################################################################

########################################################################################################################

########################################################################################################################

########################################################################################################################

########################################################################################################################

########################################################################################################################

########################################################################################################################

########################################################################################################################

########################################################################################################################

########################################################################################################################

########################################################################################################################

########################################################################################################################

########################################################################################################################

########################################################################################################################

########################################################################################################################

########################################################################################################################

########################################################################################################################

########################################################################################################################

########################################################################################################################

########################################################################################################################

########################################################################################################################

########################################################################################################################

########################################################################################################################

########################################################################################################################

########################################################################################################################

########################################################################################################################

########################################################################################################################
########################################################################################################################

########################################################################################################################

########################################################################################################################

########################################################################################################################

########################################################################################################################

  
########################################################################################################################

##################################################################################################################################################
